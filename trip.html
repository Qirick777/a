<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>íŒŒì£¼ ì—¬í–‰ ì‘ì „ë…¸íŠ¸</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Canvas Confetti (í­ì£½ íš¨ê³¼ ë¼ì´ë¸ŒëŸ¬ë¦¬) -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Do+Hyeon&family=Gaegu:wght@300;400;700&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        army: {
                            light: '#AABF89', // ë” ë°ì€ íŒŒìŠ¤í…” ì¹´í‚¤
                            base: '#6B8E23',  // ì˜¬ë¦¬ë¸Œ ë“œë©
                            dark: '#4A5D23',
                            pastel: '#F7F9F0', // ì¢…ì´ ëŠë‚Œ ë°°ê²½
                        },
                        paper: '#FFFDF5', // ëˆ„ëŸ° ì¢…ì´ ìƒ‰
                        tape: {
                            1: '#E6B8B8', // í•‘í¬ í…Œì´í”„
                            2: '#B8CCE6', // ë¸”ë£¨ í…Œì´í”„
                            3: '#E6E2B8', // ì˜ë¡œìš° í…Œì´í”„
                            4: '#B8E6C5', // ê·¸ë¦° í…Œì´í”„
                        }
                    },
                    fontFamily: {
                        'title': ['Do Hyeon', 'sans-serif'],
                        'hand': ['Gaegu', 'cursive'],
                        'impact': ['Black Han Sans', 'sans-serif'],
                    },
                    boxShadow: {
                        'sticker': '2px 3px 0px rgba(0, 0, 0, 0.15)',
                        'paper': '1px 2px 4px rgba(0, 0, 0, 0.05)',
                        'floating': '0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)',
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background-color: #F7F9F0;
            background-image: 
                linear-gradient(#E5E7DC 1px, transparent 1px),
                linear-gradient(90deg, #E5E7DC 1px, transparent 1px);
            background-size: 20px 20px;
            font-family: 'Gaegu', cursive;
            -webkit-tap-highlight-color: transparent;
        }
        
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        @keyframes popIn {
            0% { transform: scale(0.8) rotate(-5deg); opacity: 0; }
            60% { transform: scale(1.05) rotate(2deg); opacity: 1; }
            100% { transform: scale(1) rotate(0deg); opacity: 1; }
        }
        .quest-popup {
            animation: popIn 0.4s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
        }
        
        .day-tab.active {
            background-color: #6B8E23;
            color: white;
            transform: translateY(-2px);
            box-shadow: 2px 3px 0px rgba(74, 93, 35, 0.3);
            border: 2px solid #4A5D23;
        }
        .day-tab {
            background-color: #FFF;
            color: #6B8E23;
            border: 2px solid #AABF89;
            border-bottom: 4px solid #AABF89;
        }

        /* ì²´í¬ë°•ìŠ¤ ì»¤ìŠ¤í…€ */
        .custom-checkbox:checked + div {
            background-color: #6B8E23;
            border-color: #4A5D23;
            transform: scale(1.1);
        }
        
        /* ë§ˆìŠ¤í‚¹ í…Œì´í”„ íš¨ê³¼ */
        .masking-tape {
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%) rotate(-2deg);
            width: 80px;
            height: 24px;
            background-color: rgba(230, 230, 230, 0.8);
            opacity: 0.8;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
            z-index: 10;
        }
        .masking-tape::before, .masking-tape::after {
            content: '';
            position: absolute;
            width: 4px;
            height: 100%;
            background: white;
            opacity: 0.3;
        }
        .masking-tape::before { left: -2px; border-right: 1px dotted gray; }
        .masking-tape::after { right: -2px; border-left: 1px dotted gray; }

        /* ì™„ë£Œëœ í•­ëª© ìŠ¤íƒ€ì¼ */
        .item-completed {
            opacity: 0.7;
            filter: grayscale(0.5);
            transform: scale(0.98);
        }
        .item-completed::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 5%;
            width: 90%;
            height: 2px;
            background: #FF4444;
            transform: rotate(-1deg);
            opacity: 0.6;
            pointer-events: none;
        }

        /* í† ìŠ¤íŠ¸ ë©”ì‹œì§€ ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes slideUpFade {
            0% { transform: translate(-50%, 20px); opacity: 0; }
            100% { transform: translate(-50%, 0); opacity: 1; }
        }
        .toast-msg {
            animation: slideUpFade 0.3s ease-out forwards;
        }
    </style>
</head>
<body class="text-gray-800 h-screen flex flex-col overflow-hidden max-w-md mx-auto shadow-2xl bg-[#F7F9F0] border-x-4 border-army-light/30">

    <!-- Header -->
    <header class="bg-army-base p-4 pt-6 text-center shadow-md z-20 relative rounded-b-3xl mx-2 mt-[-10px] border-b-4 border-army-dark">
        <!-- ìŠ¤í”„ë§ êµ¬ë© ì¥ì‹ -->
        <div class="absolute top-2 left-0 w-full flex justify-between px-6">
            <div class="w-3 h-3 rounded-full bg-gray-800/20"></div>
            <div class="w-3 h-3 rounded-full bg-gray-800/20"></div>
            <div class="w-3 h-3 rounded-full bg-gray-800/20"></div>
            <div class="w-3 h-3 rounded-full bg-gray-800/20"></div>
            <div class="w-3 h-3 rounded-full bg-gray-800/20"></div>
            <div class="w-3 h-3 rounded-full bg-gray-800/20"></div>
        </div>

        <h1 class="text-3xl text-[#FFFDF5] font-title tracking-wider drop-shadow-md flex items-center justify-center gap-2">
            <i class="fas fa-star text-yellow-300 text-xl animate-pulse"></i>
            íŒŒì£¼ ì—¬í–‰ ì‘ì „ë…¸íŠ¸
            <i class="fas fa-star text-yellow-300 text-xl animate-pulse"></i>
        </h1>
        <div class="inline-block bg-army-dark/30 rounded-full px-4 py-1 mt-2">
            <p class="text-[#FFFDF5] text-sm font-hand tracking-widest">D-DAY OPERATION</p>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="flex-1 overflow-y-auto relative hide-scrollbar p-5 pb-24 flex flex-col z-10">
        
        <!-- Day Selector Tabs -->
        <div class="flex space-x-3 mb-6 sticky top-0 bg-[#F7F9F0]/90 backdrop-blur-sm pt-2 pb-3 z-20 overflow-x-auto shrink-0 px-1">
            <button onclick="switchDay(1)" id="day-btn-1" class="day-tab flex-1 py-2 px-3 rounded-xl font-title text-lg shadow-sm whitespace-nowrap transition-all duration-200">
                1ì¼ì°¨ ğŸŒ¤ï¸
            </button>
            <button onclick="switchDay(2)" id="day-btn-2" class="day-tab flex-1 py-2 px-3 rounded-xl font-title text-lg shadow-sm whitespace-nowrap transition-all duration-200">
                2ì¼ì°¨ ğŸ€
            </button>
            <button onclick="switchDay(3)" id="day-btn-3" class="day-tab flex-1 py-2 px-3 rounded-xl font-title text-lg shadow-sm whitespace-nowrap transition-all duration-200">
                3ì¼ì°¨ ğŸ¡
            </button>
        </div>

        <!-- Day Content Containers -->
        <div id="day1-list" class="space-y-6"></div>
        <div id="day2-list" class="hidden space-y-6"></div>
        <div id="day3-list" class="hidden space-y-6"></div>

        <!-- Reset Button -->
        <div class="mt-12 text-center">
            <button onclick="resetTrip()" class="text-gray-400 text-sm underline hover:text-red-400 font-hand">
                ì—¬í–‰ ê¸°ë¡ ì´ˆê¸°í™”í•˜ê¸° (ë‹¤ì‹œ ì‹œì‘)
            </button>
        </div>
    </main>

    <!-- Quest Complete Overlay -->
    <div id="quest-overlay" class="fixed inset-0 bg-black/60 backdrop-blur-sm z-50 hidden flex items-center justify-center p-6">
        <div class="quest-popup bg-paper rounded-sm w-full max-w-sm shadow-2xl relative flex flex-col border-8 border-white transform rotate-1" style="box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.4), 0 10px 10px -5px rgba(0, 0, 0, 0.2);">
            
            <!-- Close Button -->
            <button onclick="closePopup()" class="absolute -top-4 -right-4 z-30 bg-red-400 text-white rounded-full w-10 h-10 flex items-center justify-center shadow-sticker hover:bg-red-500 hover:scale-110 transition-all border-2 border-white">
                <i class="fas fa-times text-xl"></i>
            </button>

            <!-- Taped Header -->
            <div class="absolute -top-3 left-1/2 -translate-x-1/2 bg-yellow-200/90 w-32 h-8 rotate-1 shadow-sm z-20"></div>
            <div class="text-center pt-8 pb-2 px-4 relative z-10">
                <h2 id="popup-title" class="text-2xl text-army-dark font-title tracking-wide border-b-2 border-dashed border-army-light/50 pb-2 inline-block">í€˜ìŠ¤íŠ¸ ì™„ë£Œ!</h2>
            </div>
            
            <!-- Polaroid Image Area -->
            <div class="px-4 pb-2">
                <div class="bg-black p-1 shadow-inner rounded-sm">
                    <div id="popup-image-area" class="relative w-full aspect-square bg-gray-100 group shrink-0 overflow-hidden">
                        <!-- Media Container -->
                        <div id="popup-media-container" class="w-full h-full flex items-center justify-center bg-gray-900"></div>
                        
                        <!-- Slider Controls -->
                        <div id="slider-controls" class="hidden">
                            <button onclick="prevImage()" class="absolute left-2 top-1/2 -translate-y-1/2 bg-white/80 w-8 h-8 rounded-full text-army-dark shadow-md z-10 hover:bg-white flex items-center justify-center">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <button onclick="nextImage()" class="absolute right-2 top-1/2 -translate-y-1/2 bg-white/80 w-8 h-8 rounded-full text-army-dark shadow-md z-10 hover:bg-white flex items-center justify-center">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                            <div class="absolute bottom-2 right-2 bg-black/60 text-white text-xs px-2 py-1 rounded-md font-sans z-10">
                                <span id="img-idx">1</span> / <span id="img-total">1</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Handwritten Note Area -->
            <div class="p-5 flex-1 bg-[url('https://www.transparenttextures.com/patterns/lined-paper.png')]">
                <p id="popup-desc" class="text-gray-700 text-lg font-hand leading-7 break-keep whitespace-pre-wrap" style="line-height: 1.8;"></p>
                <div class="mt-4 text-right">
                    <span class="inline-block bg-army-light/30 px-2 py-1 rounded text-army-dark text-sm transform -rotate-2">
                        <i class="fas fa-heart text-red-400 mr-1"></i> ì„œì§„ì´ì™€ í•¨ê»˜
                    </span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- Data: Itinerary ---
        const itinerary = {
            day1: [
                { 
                    raw: "12:00 ğŸš— ì¼ì‚°í˜¸ìˆ˜ê³µì› ì£¼ì°¨(3ì‹œê°„ 2500ì›), ì›¨ìŠ¤í„´ë” ë„ì°©", 
                    quest: true,
                    images: [
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/dom.jpg",
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/maras.jpg",
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/mara.jpg",
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/yup.jpg"
                    ],
                    popupTitle: "êµ°ëŒ€ì—ì„œì˜ í¬ë¦¬ìŠ¤ë§ˆìŠ¤",
                    popupDesc: "12ì›” 16ì¼, ì•„ì§ í¬ë¦¬ìŠ¤ë§ˆìŠ¤ëŠ” ì•„ë‹ˆì—ˆì§€ë§Œ ì™¸ë°•ì„ ë‚˜ì™€ì„œ í¬ë¦¬ìŠ¤ë§ˆìŠ¤ ë¶„ìœ„ê¸°ë¥¼ ë‚¸ ë‚ ~ ì›¨ìŠ¤í„´ ë”ì— ì™€ì„œ ë§ˆë¼íƒ•ë„ ë¨¹ê³ , ì—½ê¸° ë–¡ë³¶ì´ë„ ë¨¹ì—ˆì—ˆì§€. ë‹¤ì‹œ ê²¨ìš¸ì— ì´ê³³ì— ì˜¤ë‹¤ë‹ˆ. ì €ë²ˆë‹¬ì— í¬ë¦¬ìŠ¤ë§ˆìŠ¤ì˜€ìœ¼ë‹ˆê¹Œ, í¬ë¦¬ìŠ¤ë§ˆìŠ¤ íŠ¸ë¦¬ ë˜‘ê°™ì€ê²Œ ê·¸ëŒ€ë¡œ ìˆì„ê¹Œ?ã…‹ã…‹",
                    mapQuery: "ì¼ì‚° ì›¨ìŠ¤í„´ë”"
                },
                { 
                    raw: "ğŸœ ê²ë¡œì¿  ìš°ë™ì—ì„œ ì ì‹¬", 
                    quest: false,
                    mapQuery: "ì¼ì‚° ê²ë¡œì¿ ìš°ë™"
                },
                { 
                    raw: "â˜• ë¼í…Œë¼ìŠ¤ë“œíŒŒë¦¬", 
                    quest: false,
                    mapQuery: "ì¼ì‚° ë¼í…Œë¼ìŠ¤ë“œíŒŒë¦¬"
                },
                { 
                    raw: "15:00 ğŸ¦† ì¼ì‚°í˜¸ìˆ˜ê³µì› (ìˆ˜ìƒê½ƒìì „ê±° 2ì¸ìš© 14000ì›)", 
                    quest: true,
                    images: [
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/il0.jpg",
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/il1.jpg",
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/il2.jpg",
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/il3.jpg",
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/il4.jpg"
                    ],
                    popupTitle: "ê½ƒë„ ë³´ê³  ë¬¼ ìœ„ë„ ë– ë‹¤ë…”ë˜ ê·¸ë‚ ",
                    popupDesc: "ì´ ë‚ ì€ ì¼ì‚°í˜¸ìˆ˜ê³µì›ì— ê½ƒì´ í™œì§ í”¼ì—ˆì—ˆë˜ ë‚ ì´ì—ˆì–´. 24ë…„ 5ì›” 4ì¼, ê±°ì˜ ì „ì—­ì´ ì–¼ë§ˆ ë‚¨ì§€ ì•Šì•˜ì—ˆì„ ë•Œì˜€ì§€. ê°™ì´ ë¬¼ ìœ„ì—ì„œ ìˆ˜ìƒìì „ê±°ë„ íƒ€ë©´ì„œ ì–˜ê¸°ë„ í•˜ê³  í‰í™”ë¡œì›Œì„œ ë„ˆë¬´ ì¦ê±°ì› ì—ˆì–´.",
                    mapQuery: "ì¼ì‚°í˜¸ìˆ˜ê³µì›"
                },
                { 
                    raw: "16:00 ğŸ¨ ê¸ˆì´Œì— ìˆ™ì†Œ ì²´í¬ì¸", 
                    quest: false,
                    mapQuery: "íŒŒì£¼ ê¸ˆì´Œì—­"
                },
                { 
                    raw: "~17:00 ğŸ™ï¸ ê¸ˆì´Œì—­ ì£¼ë³€ êµ¬ê²½(ê¸ˆì´Œì—­ ë“¤ì–´ê°€ì„œ ë‚˜ì˜¤ëŠ” ë£¨íŠ¸, ì‚¬ì§„ì°ê¸°)", 
                    quest: true,
                    images: [
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/g1.jpg",
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/g2.jpg",
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/g3.jpg",
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/g4.jpg",
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/g5.jpg",
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/g6.jpg"
                    ],
                    popupTitle: "ì–´ì©Œë‹¤ë³´ë‹ˆ ì¶”ì–µì´ ê¹ƒë“  ê¸ˆì´Œì—­",
                    popupDesc: "ì™¸ì¶œ, ì™¸ë°•ë‚˜ì˜¤ë©´ ë‚˜í•œí…Œ ê°€ê¹ê¸°ë„ í•˜ê³ , ë‚˜ë¦„ ë²ˆí™”ê°€?ì—¬ì„œ ìì£¼ ì™”ë˜ ê¸ˆì´Œì—­! ì§„ì§œ ë§ì´ ìì£¼ ì™€ì„œ, ê¸ˆì´Œì—­ì²˜ëŸ¼ ë˜ì–´ìˆëŠ” ì§€í•˜ì² ì—­ë§Œ ë³´ë©´ \"ì–´! ì—¬ê¸° ê¸ˆì´Œì—­ ê°™ë‹¤~\"í•˜ê³  ë§í•˜ê³¤ í•˜ê²Œ ë˜ì—ˆë„¤. ê¸ˆì´Œì—­ì—ì„œ ì—ìŠ¤ì»¬ë ˆì´í„°ë¥¼ íƒ€ê³  ë‚´ë ¤ì˜¬ ë•Œ, ì„œì§„ì´ ì–¼êµ´ì´ ë³´ë©´ ë„ˆë¬´ë„ˆë¬´ ë°˜ê°‘ê³  ê¸°ë»¤ëŠ”ë°~ ì´ì œ ë§ˆìŒ í¸í•˜ê²Œ ì˜¬ ìˆ˜ ìˆì–´ì„œ ê¸°ì˜ë‹¤.",
                    mapQuery: "ê¸ˆì´Œì—­"
                },
                { 
                    raw: "17:00 ğŸ² ì–¸ì¹¼êµ­ìˆ˜", 
                    quest: true,
                    images: [
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/un0.jpg",
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/un1.jpg",
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/un2.mp4"
                    ],
                    popupTitle: "ìëŒ€ì˜¨ì§€ í•œë‹¬ë„ ì•ˆëœ ì§¬ì°Œì˜ ì™¸ì¶œ",
                    popupDesc: "ì´ ë‚ ì€ 5ì›” 6ì¼! ì´ì œ ë§‰ ìëŒ€ì— ì˜¨ ì§€ í•œë‹¬ ëœ ì¼ë³‘ 2í˜¸ë´‰ì˜ ë‚˜ì˜€ì–´. ì´ ë‚ , ë‹¹ì§ì‚¬ê´€í•œí…Œ ì „í™”ê°€ ì™”ëŠ”ë° ì•„ë¬´ê²ƒë„ ëª¨ë¥´ë˜ ë‚´ê°€ 'ì—¬ë³´ì„¸ìš”?'ë¼ê³  í–ˆë‹¤ê³  ë˜ ê·¸ë ‡ê²Œ ìš•ì„ ë¨¹ì—ˆì—ˆëŠ”ë°. ã…‹ã…‹ ì•„ë¬´íŠ¼, ì–¸ì¹¼êµ­ìˆ˜ ë§›ìˆì—ˆë˜ê±´ ê¸°ì–µ ë‚˜ëŠ”ë° ë¬´ìŠ¨ ë§›ì´ì—ˆëŠ”ì§€ëŠ” ì˜ ê¸°ì–µì´ ì•ˆë‚˜ë„¤. ë‹¤ì‹œ í•œë²ˆ ë¨¹ì–´ë³´ë©´ì„œ ì¶”ì–µì„ ë– ì˜¬ë ¤ë´ìš”~",
                    mapQuery: "íŒŒì£¼ ì–¸ì¹¼êµ­ìˆ˜"
                },
                { 
                    raw: "ğŸŒ™ ë°¤ì— ìˆ™ì†Œ ì£¼ë³€ ì‚°ì±…/ì•¼ì‹", 
                    quest: false,
                    mapQuery: null
                }
            ],
            day2: [
                { 
                    raw: "â­ï¸ ğŸ° ì•¨ë¦¬ìŠ¤ì¼€ì´ì»¤ë¦¬ ì¡°ê°ì¼€ì´í¬ ì˜ˆì•½", 
                    quest: true,
                    images: [
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/c1.jpg",
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/c2.jpg",
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/c3.jpg",
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/c4.jpg"
                    ],
                    popupTitle: "ì„œì§„ì´ê°€ ì¢‹ì•„í•˜ëŠ” ì¼€ì´í¬ ë§›ì§‘",
                    popupDesc: "ì¼ì‚° ì˜¤ë©´ ì—¬ê¸°ì„œ ì¼€ì´í¬ ë¨¹ê³¤ í–ˆì§€~ ë‚œ ê·¸ë ‡ê²Œ ë§›ìˆëŠ”ì§€ ëª°ëëŠ”ë°, ì „ì—­í•˜ê³  ë‚˜ì„œë„ ì„œì§„ì´ê°€ ê¸°ì–µí•  ì •ë„ë©´ ì—„ì²­ ë§›ì§‘ì´ê¸´ í—€ë‚˜ë³´ë„¤. ì—¬ê¸° í•­ìƒ ë¶€ëŒ€ ë³µê·€ í•˜ê¸° ì§ì „ì— ë“¤ë ¸ì—ˆëŠ”ë°, ì´ì œëŠ” ë–¨ì–´ì§ˆ ì¼ ì—†ì´ ë§ˆìŒ í¸íˆ ì˜¬ ìˆ˜ ìˆì–´ì„œ í–‰ë³µí•˜ë‹¤~",
                    mapQuery: "ì•¨ë¦¬ìŠ¤ì¼€ì´ì»¤ë¦¬"
                },
                { 
                    raw: "08:45 ğŸ“¸ ë¬¸ì‚° ì¸ì‹¸í¬í†  ë„ì°©(ê¸¸ì£¼ë³€ì— ì£¼ì°¨)", 
                    quest: true,
                    images: [
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/in1.jpg",
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/in2.jpg",
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/in3.jpg",
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/in4.jpg"
                    ],
                    popupTitle: "ë¶€ëŒ€ê°œë°© í–‰ì‚¬ í›„ ì¸ì‹¸í¬í†  ì°°ì¹µ!",
                    popupDesc: "ë¶€ëª¨ë‹˜ì´ ì˜¤ë©´ ì™¸ë°•ì´ ê°€ëŠ¥í•´ì„œ~ ì—„ë§ˆì•„ë¹  ë‹¤ ë°ë¦¬ê³  ì™€ë²„ë ¤ì„œ ì„œì§„ì´ë‘ ê°™ì´ ì™¸ë°•í•´ë²„ë¦° ë‚ ã…‹ã…‹ ì¸ì‹¸í¬í† ì—ì„œ ì‚¬ì§„ ì°ì—ˆëŠ”ë°, ì´ì œ ë‚˜ë„ ì‚¬ë³µ ì…ê³  ë¹„ìŠ·í•œ êµ¬ë„ë¡œ ì°ìœ¼ë©´ ì¬ë¯¸ìˆì„ê±°ê°™ì•„.",
                    mapQuery: "ë¬¸ì‚° ì¸ì‹¸í¬í† "
                },
                { 
                    raw: "ğŸ™ í†µí°ê¹€ë°¥, ë¬¸ì‚°ì—­ ì£¼ë³€ êµ¬ê²½", 
                    quest: true,
                    images: [
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/sa1.jpg",
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/sa2.jpg",
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/sa3.jpg"
                    ],
                    popupTitle: "ë§Œë‚˜ê¸° ìœ„í•´ í•­ìƒ ê±°ì¹˜ë˜ ê³³",
                    popupDesc: "ì–´ë”œ ê°€ë“  ë¬¸ì‚°ì„ í†µí•´ì•¼í–ˆì—ˆì§€. íƒì‹œë¥¼ íƒ€ë©´ 2ë§Œì›ì´ë‚˜ ë˜ë˜ ê±°ë¦¬ì§€ë§Œ ì œì¼ ê°€ê¹Œìš´ ì—­ì´ì—ˆì–´ì„œ. í•­ìƒ ì„œì§„ì´ë¥¼ ë§Œë‚˜ê¸° ìœ„í•´ ì—¬ê¸°ì— ì™”ê³ , ì„œì§„ì´ë‘ ë§Œë‚˜ê³  ë‚œ ë’¤ ë³µê·€í•  ë•Œë„ ë‹¤ì‹œ ì—¬ê¸°ë¡œ ì™”ì—ˆë˜ ê³³ì´ì—ˆì–´. ì´ì œëŠ” ì´ê³³ì—ì„œ ì‹œì‘ê³¼ ëì´ ì•„ë‹Œ, ì—¬í–‰ì˜ í•œ ê°€ìš´ë°ë¼ëŠ” ê²ƒì´ ì—„ì²­ ì‹ ê¸°í•˜ë‹¤.",
                    mapQuery: "ë¬¸ì‚° í†µí°ê¹€ë°¥"
                },
                { 
                    raw: "9:30 ğŸ•Šï¸ DMZ í‰í™”ê´€ê´‘ ë„ì°© (ë¬¸ì‚°ì—­ì—ì„œ 12ë¶„ê±°ë¦¬)", 
                    quest: false,
                    mapQuery: "ì„ì§„ê° í‰í™”ëˆ„ë¦¬ê³µì›"
                },
                { 
                    raw: "ğŸšŒ DMZê´€ê´‘: 10ì‹œë¶€í„°, Aì½”ìŠ¤ ì•½ 3ì‹œê°„ì •ë„", 
                    quest: false,
                    mapQuery: null
                },
                { 
                    raw: "ğŸ• ì•½ 13ì‹œê²½ DMZê´€ê´‘ ì¢…ë£Œ ì˜ˆì •", 
                    quest: false,
                    mapQuery: null
                },
                { 
                    raw: "ğŸ¥˜ ê´€ê´‘ ì¢…ë£Œ í›„, íƒ•ìˆ˜ìœ¡ì—ì„œ ì ì‹¬ (ì•½ 25ë¶„ê±°ë¦¬)", 
                    quest: true,
                    images: ["https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/tang.png"],
                    popupTitle: "ìµœì•  ì§¬ë½• ë§›ì§‘!",
                    popupDesc: "ì‚¬ì§„ì´ ì—†ëŠ” ê´€ê³„ë¡œ ë¡œë“œë·°ë¡œ ëŒ€ì²´... ì•„ë¬´íŠ¼, ë‚˜í•œí…Œ ìµœì• ì˜€ëŠ”ë°, ê³¼ì—° êµ°ëŒ€ì—ì„œ ëª»ë¨¹ì—ˆì–´ì„œ ë¯¸í™”ëœê±¸ê¹Œ, ì•„ë‹ˆë©´ ì§„ì§œ ë§›ìˆì—ˆë˜ê±¸ê¹Œ?ã…‹ã…‹",
                    mapQuery: "íŒŒì£¼ íƒ•ìˆ˜ìœ¡" // ì‹¤ì œ ìƒí˜¸ëª…ì´ 'íƒ•ìˆ˜ìœ¡'ì¸ ê³³ ê°€ì •
                },
                { 
                    raw: "15:00 ğŸ”­ ìƒìŠ¹ì „ë§ëŒ€", 
                    quest: true,
                    images: null,
                    popupTitle: "ì„œì§„ì´ëŠ” ëª¨ë¥´ëŠ”, ë‚˜ë§Œ ë“œë‚˜ë“¤ë˜ ê³³ì—",
                    popupDesc: "7í˜¸ì°¨ ìš´ì „ë³‘ì„ í•˜ë©´ì„œ, í›ˆë ¨ì´ë¼ë˜ê°€ ì¶œë™í•˜ê²Œ ë˜ë©´ 3ëŒ€ëŒ€ ë°¥ì¬ì†Œì´ˆ ìª½ìœ¼ë¡œ í•´ì„œ ì´ ê³³ì— ìì£¼ ì˜¤ê³¤ í–ˆì—ˆì§€. ë‚œ ì‚¬ì‹¤ ì„œì§„ì´ë‘ ì´ê³³ì— ì˜¬ ìˆ˜ ìˆë‹¤ëŠ”ê²Œ ë„ˆë¬´ ì‹ ê¸°í•˜ê³  ì„¤ë Œë‹¤ã…ã…. ë‚˜ë§Œ í˜¼ì ì˜¤ë˜ ê³³ì¸ë° ì„œì§„ì´ë‘ ê°™ì´ ì˜¤ë‹¤ë‹ˆã… ã… ",
                    mapQuery: "ìƒìŠ¹ì „ë§ëŒ€"
                },
                { 
                    raw: "15:20 ğŸ˜ï¸ ì—°ëŒ€ì• ê²½ìœ í•´ì„œ ì ì„± ë„ì°©, ì ì„± ì£¼ë³€ êµ¬ê²½ (í•œì–¼ì•„íŒŒíŠ¸~ê¸°íƒ€ë“±ë“±)", 
                    quest: true,
                    images: [
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/js1.jpg",
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/js2.jpg",
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/js3.jpg",
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/js4.jpg",
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/js5.jpg",
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/js6.jpg",
                        "https://raw.githubusercontent.com/Qirick777/a/refs/heads/main/js7.jpg"
                    ],
                    popupTitle: "ë‚´ ìƒì¼ì„ ì¶•í•˜í•˜ë˜ ê³³ì—ì„œ, ì„œì§„ì´ ìƒì¼ì„ ì¶•í•˜í•˜ëŠ” ê³³ìœ¼ë¡œ",
                    popupDesc: "ë‚´ ìƒì¼, í‰ì¼ ì™¸ì¶œì´ë¼ì„œ ì–¼ë§ˆ ëª» ë³´ëŠ”ë°ë„ ì„œì§„ì´ê°€ ì¶•í•˜í•´ì£¼ë ¤ê³  ì ì„±ê¹Œì§€ ì™”ì—ˆì—ˆì§€ã… ã…  ë„ˆë¬´ë‚˜ë„ ê°ë™ì´ê³  ê³ ë§ˆì› ì–´. ì´ì œ ì´ê³³ì—ì„œ ë‚´ê°€ ì„œì§„ì´ì˜ ìƒì¼ì„ ì¶•í•˜í•´ì¤„ê²Œ.",
                    mapQuery: "íŒŒì£¼ ì ì„±ë©´"
                },
                { 
                    raw: "16:00 ğŸŒ‰ ê°ì•…ì‚° ì¶œë ë‹¤ë¦¬(ì•¼ê°„ê²½ê´€ì¡°ëª…í–‰ì‚¬)", 
                    quest: false,
                    mapQuery: "ê°ì•…ì‚° ì¶œë ë‹¤ë¦¬"
                },
                { 
                    raw: "17:40 ğŸ¥“ ì‹¹ìŠ¤ë¦¬ì†¥ëšœê»‘ê¹€ì¹˜ì‚¼ê²¹ì‚´", 
                    quest: false,
                    mapQuery: "ì‹¹ì“°ë¦¬ì†¥ëšœê»‘ê¹€ì¹˜ì‚¼ê²¹ì‚´"
                },
                { 
                    raw: "ğŸ ì•¨ë¦¬ìŠ¤ì¼€ì´ì»¤ë¦¬ ì¼€ì´í¬í”½ì—…", 
                    quest: false,
                    mapQuery: "ì•¨ë¦¬ìŠ¤ì¼€ì´ì»¤ë¦¬"
                }
            ],
            day3: [
                { 
                    raw: "12:00 ğŸ› íš¨êµ ì ì‹¬ì‹ì‚¬", 
                    quest: false,
                    mapQuery: "íŒŒì£¼ íš¨êµ"
                },
                { 
                    raw: "13:00 ğŸ¦ í”½ì»¤ìŠ¤ ìš”ê±°íŠ¸", 
                    quest: false,
                    mapQuery: "íŒŒì£¼ í”½ì»¤ìŠ¤"
                },
                { 
                    raw: "ğŸ§¸ ê¼¬ëª¨ë‹¤ë¯¸ ì†Œí’ˆìƒµ", 
                    quest: false,
                    mapQuery: "ê¼¬ëª¨ë‹¤ë¯¸"
                },
                { 
                    raw: "13:30 ğŸª íœ˜ë‚­ì‹œì—ë¥´", 
                    quest: false,
                    mapQuery: "íœ˜ë‚­ì‹œì—ë¥´"
                },
                { 
                    raw: "ğŸ í¬ì½”í¬ì½” ì†Œí’ˆìƒµ", 
                    quest: false,
                    mapQuery: "í¬ì½”í¬ì½”"
                },
                { 
                    raw: "ğŸŒ¿ í¬ë ˆìŠ¤íŠ¸ì•„ì›ƒíŒ…ìŠ¤ êµ¬ê²½", 
                    quest: false,
                    mapQuery: "í¬ë ˆìŠ¤íŠ¸ì•„ì›ƒíŒ…ìŠ¤"
                },
                { 
                    raw: "ğŸ¦ª êµ´ì„¸ìƒ(-18ì‹œ)", 
                    quest: false,
                    mapQuery: "êµ´ì„¸ìƒ"
                },
                { 
                    raw: "ğŸ° í–‰ì£¼ì‚°ì„±", 
                    quest: false,
                    mapQuery: "í–‰ì£¼ì‚°ì„±"
                }
            ]
        };

        // --- Persistence Logic ---
        const STORAGE_KEY = 'pajuTripProgress_v2';
        
        function getCompletedItems() {
            const saved = localStorage.getItem(STORAGE_KEY);
            return saved ? new Set(JSON.parse(saved)) : new Set();
        }

        function toggleCompletion(uniqueId) {
            const completed = getCompletedItems();
            let isAdding = false;
            
            if (completed.has(uniqueId)) {
                completed.delete(uniqueId);
            } else {
                completed.add(uniqueId);
                isAdding = true;
            }
            localStorage.setItem(STORAGE_KEY, JSON.stringify([...completed]));
            
            updateItemUI(uniqueId, completed.has(uniqueId));
            
            if (isAdding) showToast("ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ’¾");
        }

        function markAsCompleted(uniqueId) {
            const completed = getCompletedItems();
            if (!completed.has(uniqueId)) {
                completed.add(uniqueId);
                localStorage.setItem(STORAGE_KEY, JSON.stringify([...completed]));
                updateItemUI(uniqueId, true);
                showToast("ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ’¾");
            }
        }

        function resetTrip() {
            if(confirm("ëª¨ë“  ì—¬í–‰ ê¸°ë¡ì„ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                localStorage.removeItem(STORAGE_KEY);
                location.reload();
            }
        }

        function updateItemUI(uniqueId, isCompleted) {
            const el = document.getElementById(`item-${uniqueId}`);
            if (el) {
                if (isCompleted) {
                    el.classList.add('item-completed');
                    const checkbox = el.querySelector('.custom-checkbox');
                    if (checkbox) checkbox.checked = true;
                } else {
                    el.classList.remove('item-completed');
                    const checkbox = el.querySelector('.custom-checkbox');
                    if (checkbox) checkbox.checked = false;
                }
            }
        }

        function showToast(message) {
            const toast = document.createElement('div');
            toast.className = 'fixed bottom-20 left-1/2 transform -translate-x-1/2 bg-gray-800/90 text-white px-4 py-2 rounded-full text-sm font-hand z-50 shadow-lg toast-msg border border-gray-600';
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.classList.add('opacity-0', 'transition-opacity', 'duration-500');
                setTimeout(() => toast.remove(), 500);
            }, 1500);
        }

        // --- Logic: Render Schedule with New Design ---
        const tapeColors = ['#E6B8B8', '#B8CCE6', '#E6E2B8', '#B8E6C5'];

        function renderSchedule(dayId, data, dayNum) {
            const container = document.getElementById(dayId);
            const completedItems = getCompletedItems();
            let html = '';

            data.forEach((item, index) => {
                const uniqueId = `d${dayNum}-${index}`;
                const isCompleted = completedItems.has(uniqueId);
                
                // ë§ˆìŠ¤í‚¹ í…Œì´í”„ ìƒ‰ìƒ ëœë¤ (ì¸ë±ìŠ¤ ê¸°ë°˜)
                const tapeColor = tapeColors[index % tapeColors.length];
                // ì•½ê°„ì˜ íšŒì „ (ì†ìœ¼ë¡œ ë¶™ì¸ ëŠë‚Œ)
                const rotate = (index % 3 - 1) * 1; 

                // ê´„í˜¸ ìŠ¤íƒ€ì¼ë§
                let title = item.raw;
                const parenMatch = item.raw.match(/\(([^)]+)\)/);
                if (parenMatch) {
                    title = item.raw.replace(/\(([^)]+)\)/g, '<span class="text-base text-gray-500 font-hand tracking-tight ml-1">($1)</span>');
                }

                html += `
                <div id="item-${uniqueId}" 
                     class="relative bg-white p-5 pt-8 rounded-sm shadow-paper border border-gray-100 transition-all duration-300 ${isCompleted ? 'item-completed' : ''}"
                     style="transform: rotate(${rotate}deg);">
                    
                    <!-- Masking Tape -->
                    <div class="masking-tape" style="background-color: ${tapeColor}EE;"></div>

                    <!-- Text Content -->
                    <div class="mb-4 pl-2 border-l-4 border-army-light/30">
                        <h3 class="title-text font-title text-xl text-gray-800 leading-snug break-keep transition-all duration-300">
                            ${title}
                        </h3>
                    </div>

                    <!-- Action Area -->
                    <div class="flex items-center justify-between mt-3 pt-3 border-t-2 border-dashed border-gray-100">
                        <!-- Left: Checkbox or Quest Button -->
                        ${item.quest 
                          ? `<button onclick="handleQuestClick('${uniqueId}')" class="group relative bg-army-base text-white font-hand text-lg px-4 py-2 rounded-xl shadow-sticker hover:translate-y-1 hover:shadow-none transition-all border-2 border-white overflow-hidden">
                               <span class="relative z-10 flex items-center">
                                 <i class="fas fa-star mr-2 text-yellow-300 animate-spin-slow"></i>ì¶”ì–µ ë³´ê¸°
                               </span>
                               <div class="absolute inset-0 bg-white opacity-0 group-hover:opacity-20 transition-opacity"></div>
                             </button>`
                          : `<label class="flex items-center cursor-pointer select-none group">
                               <input type="checkbox" class="hidden custom-checkbox" 
                                      onchange="toggleCompletion('${uniqueId}')" ${isCompleted ? 'checked' : ''}>
                               <div class="w-8 h-8 rounded-full border-2 border-army-light bg-paper flex items-center justify-center transition-all group-hover:bg-army-pastel shadow-sm">
                                 <i class="fas fa-check text-army-dark hidden text-xl"></i>
                               </div>
                               <span class="ml-3 text-lg text-gray-500 font-hand group-hover:text-army-base transition-colors">ì™„ë£Œí•˜ê¸°</span>
                             </label>`
                        }

                        <!-- Right: Map Button (Sticker style) -->
                        ${item.mapQuery ? `
                        <a href="https://map.kakao.com/link/search/${item.mapQuery}" target="_blank" 
                           class="bg-white text-army-base border-2 border-army-light px-3 py-1.5 rounded-full text-base font-bold shadow-sm hover:bg-army-light hover:text-white hover:border-army-light transition-all flex items-center">
                            <i class="fas fa-map-marked-alt mr-1"></i>ì§€ë„
                        </a>
                        ` : ''}
                    </div>
                    
                    <!-- Decorative element (sticker) for quest items -->
                    ${item.quest ? `<div class="absolute -bottom-2 -right-2 text-4xl opacity-20 rotate-12">ğŸ</div>` : ''}
                </div>
                `;
            });

            container.innerHTML = html;
        }

        function switchDay(dayNum) {
            document.getElementById('day1-list').classList.add('hidden');
            document.getElementById('day2-list').classList.add('hidden');
            document.getElementById('day3-list').classList.add('hidden');
            
            document.getElementById('day-btn-1').classList.remove('active');
            document.getElementById('day-btn-2').classList.remove('active');
            document.getElementById('day-btn-3').classList.remove('active');

            document.getElementById(`day${dayNum}-list`).classList.remove('hidden');
            document.getElementById(`day-btn-${dayNum}`).classList.add('active');
            
            // íƒ­ ë³€ê²½ ì‹œ ìŠ¤í¬ë¡¤ ìƒë‹¨ìœ¼ë¡œ
            document.querySelector('main').scrollTop = 0;
        }

        let currentImages = [];
        let currentIdx = 0;

        function handleQuestClick(uniqueId) {
            markAsCompleted(uniqueId);
            openQuestPopup(uniqueId);
            triggerFireworks();
        }

        function triggerFireworks() {
            var duration = 2 * 1000;
            var animationEnd = Date.now() + duration;
            var defaults = { startVelocity: 30, spread: 360, ticks: 60, zIndex: 100 };

            var randomInRange = (min, max) => Math.random() * (max - min) + min;

            var interval = setInterval(function() {
                var timeLeft = animationEnd - Date.now();

                if (timeLeft <= 0) {
                    return clearInterval(interval);
                }

                var particleCount = 50 * (timeLeft / duration);
                
                confetti(Object.assign({}, defaults, { 
                    particleCount, 
                    origin: { x: randomInRange(0.1, 0.3), y: Math.random() - 0.2 } 
                }));
                confetti(Object.assign({}, defaults, { 
                    particleCount, 
                    origin: { x: randomInRange(0.7, 0.9), y: Math.random() - 0.2 } 
                }));
            }, 250);
        }

        function openQuestPopup(uniqueId) {
            const [d, idx] = uniqueId.replace('d', '').split('-');
            const dayKey = `day${d}`;
            const item = itinerary[dayKey][idx];

            if (!item || !item.quest) return;

            document.getElementById('popup-title').textContent = item.popupTitle || "í€˜ìŠ¤íŠ¸ ì™„ë£Œ!";
            document.getElementById('popup-desc').textContent = item.popupText || item.popupDesc || "ì‘ì „ ì„±ê³µ!";
            
            const imgArea = document.getElementById('popup-image-area');

            if (item.images && item.images.length > 0) {
                currentImages = item.images;
                currentIdx = 0;
                imgArea.classList.remove('hidden');
                updateSlider();
            } else {
                currentImages = [];
                imgArea.classList.add('hidden');
            }
            
            document.getElementById('quest-overlay').classList.remove('hidden');
        }

        function updateSlider() {
            const container = document.getElementById('popup-media-container');
            const controls = document.getElementById('slider-controls');
            const idxEl = document.getElementById('img-idx');
            const totalEl = document.getElementById('img-total');

            const currentSrc = currentImages[currentIdx];
            const isVideo = currentSrc.endsWith('.mp4');

            container.innerHTML = '';

            if (isVideo) {
                const video = document.createElement('video');
                video.src = currentSrc;
                video.controls = true;
                video.autoplay = true;
                video.className = "w-full h-full object-contain bg-black";
                container.appendChild(video);
            } else {
                const img = document.createElement('img');
                img.src = currentSrc;
                img.alt = "Memory";
                img.className = "w-full h-full object-cover border-4 border-white shadow-inner";
                container.appendChild(img);
            }

            if (currentImages.length > 1) {
                controls.classList.remove('hidden');
                idxEl.textContent = currentIdx + 1;
                totalEl.textContent = currentImages.length;
            } else {
                controls.classList.add('hidden');
            }
        }

        function nextImage() {
            if (currentImages.length <= 1) return;
            currentIdx = (currentIdx + 1) % currentImages.length;
            updateSlider();
        }

        function prevImage() {
            if (currentImages.length <= 1) return;
            currentIdx = (currentIdx - 1 + currentImages.length) % currentImages.length;
            updateSlider();
        }

        function closePopup() {
            document.getElementById('popup-media-container').innerHTML = '';
            document.getElementById('quest-overlay').classList.add('hidden');
        }

        function initApp() {
            renderSchedule('day1-list', itinerary.day1, 1);
            renderSchedule('day2-list', itinerary.day2, 2);
            renderSchedule('day3-list', itinerary.day3, 3);

            const completed = getCompletedItems();
            const isDayComplete = (dayKey, dayNum) => {
                return itinerary[dayKey].every((_, idx) => completed.has(`d${dayNum}-${idx}`));
            };

            let targetDay = 1;
            if (isDayComplete('day1', 1)) {
                targetDay = 2;
                if (isDayComplete('day2', 2)) {
                    targetDay = 3;
                }
            }
            switchDay(targetDay);
        }

        initApp();
    </script>
</body>
</html>